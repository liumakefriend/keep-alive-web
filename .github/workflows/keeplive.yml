name: Simulate Login (Method 2)

on:
  schedule:
    - cron: '0 0 * * *' # 每天运行
  workflow_dispatch:    # 支持手动运行

jobs:
  simulate_login:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v4

    - name: Setup Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '18'

    - name: Install Dependencies
      run: npm install

    - name: Run Login Script
      env:
        LUNES_EMAIL: ${{ secrets.LUNES_EMAIL }}
        LUNES_PASSWORD: ${{ secrets.LUNES_PASSWORD }}
        TARGET_URL: ${{ secrets.TARGET_URL }}
      run: node login_script.js

    # 关键步骤：如果脚本失败，把截图传上来，让你知道死在哪一步
    - name: Upload Debug Screenshots
      if: always() 
      uses: actions/upload-artifact@v4
      with:
        name: debug-screenshots
        path: "*.png"
